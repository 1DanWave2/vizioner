export function $ (s,r=document){return r.querySelector(s);} export function $all(s,r=document){return Array.from(r.querySelectorAll(s));} export function setActiveNav(){const p=(location.pathname.split('/').pop()||'index.html').toLowerCase();document.querySelectorAll('.navlinks a').forEach(a=>{const h=(a.getAttribute('href')||'').toLowerCase();a.classList.toggle('active', h.endsWith(p));});} export async function loadWorks(){const res=await fetch('data/works.json',{cache:'no-store'}); if(!res.ok) throw new Error('Не удалось'); return await res.json();} export function initParallax(){const s=document.querySelectorAll('.parallax[data-parallax]'); if(!s.length) return; const onScroll=()=>{const vh=window.innerHeight; s.forEach(sec=>{const layer=sec.querySelector('.layer'); if(!layer) return; const r=sec.getBoundingClientRect(); const center=r.top + r.height/2; const t=(center - vh/2)/vh; const offset=Math.max(-60, Math.min(60, t*36)); layer.style.transform=`translate3d(0, ${offset}px, 0) scale(1.03)`;});}; const onMove=(e)=>{const x=(e.clientX/window.innerWidth-0.5)*6; const y=(e.clientY/window.innerHeight-0.5)*6; s.forEach(sec=>{const layer=sec.querySelector('.layer'); if(!layer) return; layer.style.backgroundPosition=`${50+x}% ${50+y}%`;});}; window.addEventListener('scroll', onScroll, {passive:true}); window.addEventListener('resize', onScroll); window.addEventListener('mousemove', onMove, {passive:true}); onScroll(); }